<!doctype html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Alert 90s Testing Ground</title>
    <!-- Font Awesome for HTML button demo -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" />
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/animate.css/4.1.1/animate.min.css" />
    <link
      href="https://fonts.googleapis.com/css2?family=Space+Grotesk:wght@400;700;900&display=swap"
      rel="stylesheet"
    />
    <style>
      body {
        font-family: "Space Grotesk", sans-serif;
        background-color: #f0f0f0;
        display: flex;
        gap: 1rem;
        padding: 2rem;
        flex-wrap: wrap;
        max-width: 900px;
        margin: 0 auto;
      }
      button {
        padding: 10px 20px;
        font-size: 16px;
        font-family: inherit;
        cursor: pointer;
        border: 4px solid #000;
        background: #fff;
        font-weight: bold;
        box-shadow: 4px 4px 0 0 #000;
        transition: all 0.1s;
      }
      button:active {
        box-shadow: 0 0 0 0 #000;
        transform: translate(4px, 4px);
      }
      h1 { width: 100%; border-bottom: 4px solid #000; padding-bottom: 1rem; }
      
      body.dark-mode {
        background-color: #2a2a35;
        color: #eaeaea;
      }
      body.dark-mode h1 { border-bottom-color: #eaeaea; }
      body.dark-mode button { background: #1a1a24; color: #fff; border-color: #000; }
    </style>
    <!-- Include the compiled library for testing -->
    <script src="./dist/alert90s.min.js"></script>
  </head>
  <body>
    <div id="theme-switcher" style="position: absolute; top: 1rem; right: 1rem;"></div>
    <h1>Alert90s Advanced Features</h1>
    
    <button id="btn-basic">1. Basic Message</button>
    <button id="btn-footer">2. Error + Footer</button>
    <button id="btn-html">3. HTML & ARIA</button>
    <button id="btn-three">4. Three Buttons</button>
    <button id="btn-position">5. Position & Timer</button>
    <button id="btn-animate">6. Animate.css</button>
    <button id="btn-promise">7. Promise chain</button>
    <button id="btn-custom-image">8. Custom Image</button>
    <button id="btn-auto-close">9. Auto Close</button>
    <button id="btn-drag">10. Draggable Modal</button>
    <button id="btn-rtl">11. RTL Language Support</button>
    <button id="btn-ajax">12. AJAX Request & Input</button>
    <button id="btn-colors">13. Custom Colors</button>
    <button id="btn-toast">14. Toast Notification</button>
    <button id="btn-toast-bottom">15. Toast Bottom RTL</button>
    <button id="btn-toast-info">16. Toast Top Start (Info)</button>
    <button id="btn-toast-warning">17. Toast Bottom Center (Warning)</button>
    <button id="btn-loading">18. Manual Loading Animation</button>
    <button id="btn-loading-ascii">19. ASCII Loader</button>
    <button id="btn-loading-blink">20. Blinking Loader</button>
    <button id="btn-loading-prog">21. Progress Loader</button>
    <button id="btn-loading-seg">22. Segmented Progress Bar</button>
    <button id="btn-toast-spam">23. Spam Toasts (Stacking)</button>

    <div style="width: 100%; height: 1px; background: #000; margin: 1rem 0;"></div>

    <button id="btn-input-select">23. Select Input</button>
    <button id="btn-input-radio">24. Radio Input</button>
    <button id="btn-input-checkbox">25. Checkbox Input</button>
    <button id="btn-input-toggle">26. Toggle Input</button>
    
    <div style="width: 100%; height: 1px; background: #000; margin: 1rem 0;"></div>

    <h3 style="width:100%; text-align:left; margin:0.5rem 0;">Standalone Components (no modal needed)</h3>
    <div style="display:flex; flex-wrap:wrap; gap:2rem; padding:1rem; background:#f5f5f0; border:4px solid #000; width:100%; box-sizing:border-box;">
      <div>
        <strong>Checkbox:</strong>
        <div id="standalone-cb"></div>
      </div>
      <div>
        <strong>Toggle:</strong>
        <div id="standalone-toggle"></div>
      </div>
      <div>
        <strong>Radio:</strong>
        <div id="standalone-radio"></div>
      </div>
      <div style="min-width:220px;">
        <strong>Select:</strong>
        <div id="standalone-select"></div>
      </div>
    </div>
    
    <div style="width: 100%; height: 1px; background: #000; margin: 1rem 0;"></div>
    
    <button id="btn-warning">Show Warning Alert</button>
    <button id="btn-danger">Show Danger Alert</button>
    <button id="btn-info">Show Info Alert</button>

    <script>
      // Global Theme Setup for Testing
      window.alert90sTheme = 'light';
      Alert90s.renderThemeToggle('#theme-switcher', {
        width: '120px',
        onChange: (isDark) => {
          window.alert90sTheme = isDark ? 'dark' : 'light';
          if (isDark) document.body.classList.add('dark-mode');
          else document.body.classList.remove('dark-mode');
        }
      });

      // Standalone Components Demo
      Alert90s.renderCheckbox('#standalone-cb', {
        label: 'ACCEPT TERMS',
        onChange: (checked) => console.log('Checkbox:', checked)
      });
      Alert90s.renderToggle('#standalone-toggle', {
        label: '',
        onChange: (isOn) => console.log('Toggle:', isOn)
      });
      Alert90s.renderRadio('#standalone-radio', {
        options: { easy: 'EASY', medium: 'MEDIUM', hard: 'HARD' },
        value: 'medium',
        onChange: (val) => console.log('Radio:', val)
      });
      Alert90s.renderSelect('#standalone-select', {
        placeholder: 'SELECT DRIVE',
        options: { a: 'FLOPPY (A:)', c: 'HARD DISK (C:)', d: 'CD-ROM (D:)' },
        onChange: (val) => console.log('Select:', val)
      });

      const originalFire = Alert90s.fire;
      Alert90s.fire = (opts) => originalFire.call(Alert90s, { theme: window.alert90sTheme, ...opts });
      const originalShow = Alert90s.show;
      Alert90s.show = (opts) => originalShow.call(Alert90s, { theme: window.alert90sTheme, ...opts });

      // 1. Basic Message
      document.getElementById("btn-basic").addEventListener("click", () => {
        Alert90s.fire({
          text: "CONNECTION ESTABLISHED.",
          showConfirmButton: true
        });
      });

      // 2. Error + Footer
      document.getElementById("btn-footer").addEventListener("click", () => {
        Alert90s.fire({
          icon: "error",
          title: "DISK READ ERROR",
          text: "Sector 4 is corrupted. Data loss imminent.",
          footer: '<a href="#">RUN SCANDISK.EXE NOW?</a>'
        });
      });

      // 3. HTML & ARIA
      document.getElementById("btn-html").addEventListener("click", () => {
        Alert90s.fire({
          title: "<strong>DOWNLOAD <u>COMPLETE</u></strong>",
          icon: "info",
          html: `
            File <b>DOOM_SHAREWARE.ZIP</b> has been downloaded.
            <br/><br/>
            Check your <a href="#" autofocus>C:\\DOWNLOADS</a> folder to extract.
          `,
          showCloseButton: true,
          showCancelButton: true,
          focusConfirm: false,
          confirmButtonText: '<i class="fa fa-floppy-disk"></i> INSTALL',
          confirmButtonAriaLabel: "Play Doom",
          cancelButtonText: '<i class="fa fa-trash"></i> DELETE',
          cancelButtonAriaLabel: "Delete File"
        });
      });

      // 4. Three Buttons
      document.getElementById("btn-three").addEventListener("click", () => {
        Alert90s.fire({
          title: "OVERWRITE CONFIG.SYS?",
          showDenyButton: true,
          showCancelButton: true,
          confirmButtonText: "YES",
          denyButtonText: `NO, KEEP OLD`
        }).then((result) => {
          if (result.isConfirmed) {
            Alert90s.fire("SAVED!", "System will reboot to apply changes.", "success");
          } else if (result.isDenied) {
            Alert90s.fire("ABORTED", "Keeping old configuration.", "info");
          }
        });
      });

      // 5. Custom positioned dialog with Timer
      document.getElementById("btn-position").addEventListener("click", () => {
        Alert90s.fire({
          position: "top-end",
          icon: "success",
          title: "VIRUS DEFINITIONS UPDATED",
          showConfirmButton: false,
          timer: 1500
        });
      });

      // 6. Custom animation with Animate.css
      document.getElementById("btn-animate").addEventListener("click", () => {
        Alert90s.fire({
          title: "ACCESS GRANTED",
          text: "Entering Mainframe...",
          showClass: {
            popup: `
              animate__animated
              animate__fadeInUp
              animate__faster
            `
          },
          hideClass: {
            popup: `
              animate__animated
              animate__fadeOutDown
              animate__faster
            `
          }
        });
      });

      // 7. Confirm Dialog with Function Chain
      document.getElementById("btn-promise").addEventListener("click", () => {
        Alert90s.fire({
          title: "FORMAT C: ?",
          text: "ALL DATA WILL BE DESTROYED!",
          icon: "warning",
          showCancelButton: true,
          confirmButtonColor: "#ef4444",
          cancelButtonColor: "#94a3b8",
          confirmButtonText: "PROCEED"
        }).then((result) => {
          if (result.isConfirmed) {
            Alert90s.fire({
              title: "FORMAT COMPLETE",
              text: "Disk C: is now empty. Please insert DOS diskette.",
              icon: "success"
            });
          }
        });
      });

      // 8. Custom Image
      document.getElementById("btn-custom-image").addEventListener("click", () => {
        Alert90s.fire({
          title: "WINAMP.EXE",
          text: "It really whips the llama's ass!",
          imageUrl: "https://placeholder.pics/svg/400x200",
          imageWidth: 400,
          imageHeight: 200,
          imageAlt: "Retro application banner"
        });
      });

      // 9. Auto close timer
      document.getElementById("btn-auto-close").addEventListener("click", () => {
        let timerInterval;
        Alert90s.fire({
          title: "DIALING MODEM...",
          html: "Connecting to BBS in <b></b> ms.",
          timer: 2000,
          timerProgressBar: true,
          didOpen: () => {
            Alert90s.showLoading();
            const timer = Alert90s.getPopup().querySelector("b");
            timerInterval = setInterval(() => {
              timer.textContent = `${Alert90s.getTimerLeft()}`;
            }, 100);
          },
          willClose: () => {
            clearInterval(timerInterval);
          }
        }).then((result) => {
          if (result.dismiss === 'timer') {
            console.log("Connected successfully!");
          }
        });
      });

      // 10. Draggable Modal
      document.getElementById("btn-drag").addEventListener("click", () => {
        Alert90s.fire({
          title: "FILE MANAGER",
          text: "Drag this window by the header bar.",
          icon: "info",
          draggable: true
        });
      });

      // 11. RTL Language Support
      document.getElementById("btn-rtl").addEventListener("click", () => {
        Alert90s.fire({
          title: "هل تريد الاستمرار؟",
          text: "يتم تحميل النظام الآن...",
          icon: "question",
          iconHtml: "؟",
          confirmButtonText: "نعم",
          cancelButtonText: "لا",
          showCancelButton: true,
          showCloseButton: true,
          dir: 'rtl'
        });
      });

      // 12. AJAX Request Example
      document.getElementById("btn-ajax").addEventListener("click", () => {
        Alert90s.fire({
          title: "ENTER GUEST PASSWORD",
          input: "text",
          inputAttributes: {
            autocapitalize: "off"
          },
          showCancelButton: true,
          confirmButtonText: "AUTHENTICATE",
          showLoaderOnConfirm: true,
          preConfirm: async (login) => {
            try {
              const githubUrl = `https://api.github.com/users/${login}`;
              const response = await fetch(githubUrl);
              if (!response.ok) {
                return Alert90s.showValidationMessage(`
                  ${JSON.stringify(await response.json())}
                `);
              }
              return response.json();
            } catch (error) {
              Alert90s.showValidationMessage(`
                CONNECTION FAILED: ${error}
              `);
            }
          },
          allowOutsideClick: () => !Alert90s.isLoading()
        }).then((result) => {
          if (result.isConfirmed) {
            Alert90s.fire({
              title: `USER: ${result.value.login}`,
              text: "Acess Granted.",
              imageUrl: result.value.avatar_url,
              imageWidth: 200,
              imageHeight: 200
            });
          }
        });
      });

      // 13. Custom Colors Example
      document.getElementById("btn-colors").addEventListener("click", () => {
        Alert90s.fire({
          title: "MATRIX MODE",
          text: "Customizing appearance properties.",
          icon: "success",
          background: "#1a2e05",
          color: "#bef264",
          titleColor: "#4ade80",
          iconColor: "#84cc16",
          confirmButtonColor: "#84cc16",
          confirmButtonText: "WAKE UP"
        });
      });

      // 14. Toast Notification
      document.getElementById("btn-toast").addEventListener("click", () => {
        Alert90s.fire({
          toast: true,
          position: "top-end",
          icon: "success",
          title: "File Saved Successfully",
          showConfirmButton: false,
          timer: 3000,
          timerProgressBar: true
        });
      });

      // 15. Toast Bottom RTL
      document.getElementById("btn-toast-bottom").addEventListener("click", () => {
        Alert90s.fire({
          toast: true,
          position: "bottom-end",
          icon: "error",
          title: "فشل الاتصال",
          text: "حدث خطأ غير معروف.",
          showConfirmButton: false,
          showCloseButton: true,
          dir: 'rtl',
          timer: 5000
        });
      });

      // 16. Toast Top Start Info
      document.getElementById("btn-toast-info").addEventListener("click", () => {
        Alert90s.fire({
          toast: true,
          position: "top-start",
          icon: "info",
          title: "System Update",
          text: "Version 2.0 is now available.",
          showConfirmButton: false,
          showCloseButton: true,
          timer: 4000
        });
      });

      // 17. Toast Bottom Center Warning
      document.getElementById("btn-toast-warning").addEventListener("click", () => {
        Alert90s.fire({
          toast: true,
          position: "bottom",
          icon: "warning",
          title: "Low Battery",
          text: "Please connect PC to charger.",
          showConfirmButton: false,
          timer: 3500,
          background: "#fef08a",
          color: "#854d0e"
        });
      });

      // 18. Manual Loading Animation
      document.getElementById("btn-loading").addEventListener("click", () => {
        Alert90s.fire({
          title: "DOWNLOADING MORE RAM...",
          text: "Please hold the line.",
          loaderType: "hourglass",
          didOpen: () => { Alert90s.showLoading(); }
        });
        setTimeout(() => { if(Alert90s.isLoading()) Alert90s.hideLoading(); }, 3000);
      });

      // 19. ASCII Loader
      document.getElementById("btn-loading-ascii").addEventListener("click", () => {
        Alert90s.fire({
          title: "CONNECTING TO BBS...",
          loaderType: "ascii",
          didOpen: () => { Alert90s.showLoading(); }
        });
        setTimeout(() => { if(Alert90s.isLoading()) Alert90s.hideLoading(); }, 3000);
      });

      // 20. Blinking Loader
      document.getElementById("btn-loading-blink").addEventListener("click", () => {
        Alert90s.fire({
          title: "INITIALIZING DEVICE...",
          loaderType: "blinking",
          didOpen: () => { Alert90s.showLoading(); }
        });
        setTimeout(() => { if(Alert90s.isLoading()) Alert90s.hideLoading(); }, 3000);
      });

      // 21. Progress Loader
      document.getElementById("btn-loading-prog").addEventListener("click", () => {
        Alert90s.fire({
          title: "INSTALLING DOOM.EXE...",
          loaderType: "progress",
          didOpen: () => { Alert90s.showLoading(); }
        });
        setTimeout(() => { if(Alert90s.isLoading()) Alert90s.hideLoading(); }, 3000);
      });

      // 22. Segmented Progress Bar
      document.getElementById("btn-loading-seg").addEventListener("click", () => {
        Alert90s.fire({
          title: "LOADING ASSETS...",
          loaderType: "segmented",
          didOpen: () => { Alert90s.showLoading(); }
        });
        setTimeout(() => { if(Alert90s.isLoading()) Alert90s.hideLoading(); }, 7000);
      });

      // 23. Spam Toasts (Stacking Test)
      document.getElementById("btn-toast-spam").addEventListener("click", () => {
        for(let i = 0; i < 5; i++) {
          setTimeout(() => {
            Alert90s.fire({
              toast: true,
              position: "top-end",
              icon: "info",
              title: `New Message ${i+1}`,
              text: "System notification received.",
              showConfirmButton: false,
              timer: 3000
            });
          }, i * 300);
        }
      });

      // 23. Select Input
      document.getElementById("btn-input-select").addEventListener("click", () => {
        Alert90s.fire({
          title: "CHOOSE WEAPON",
          input: "select",
          inputPlaceholder: "-- Select Item --",
          inputOptions: {
            'bfg': 'BFG 9000',
            'plasma': 'Plasma Rifle',
            'shotgun': 'Super Shotgun'
          }
        }).then(res => {
          if(res.isConfirmed) Alert90s.fire("Equipped:", res.value || "Fists", "success");
        });
      });

      // 24. Radio Input
      document.getElementById("btn-input-radio").addEventListener("click", () => {
        Alert90s.fire({
          title: "DIFFICULTY",
          input: "radio",
          inputOptions: {
            'easy': 'I\'m too young to die.',
            'medium': 'Hurt me plenty.',
            'hard': 'Ultra-Violence.'
          },
          inputValue: 'hard'
        }).then(res => {
          if(res.isConfirmed) Alert90s.fire("Selection:", res.value, "info");
        });
      });

      // 25. Checkbox Input
      document.getElementById("btn-input-checkbox").addEventListener("click", () => {
        Alert90s.fire({
          title: "EULA",
          text: "I have read the Terms and Conditions.",
          input: "checkbox",
          inputPlaceholder: "I Agree"
        }).then(res => {
          if(res.isConfirmed) Alert90s.fire("Status:", res.value ? "Agreed" : "Declined", "warning");
        });
      });

      // 26. Toggle Input
      document.getElementById("btn-input-toggle").addEventListener("click", () => {
        Alert90s.fire({
          title: "SETTINGS",
          input: "toggle",
          inputPlaceholder: "God Mode",
          inputValue: true
        }).then(res => {
          if(res.isConfirmed) Alert90s.fire("God Mode:", res.value ? "ENABLED" : "DISABLED", "success");
        });
      });

      // Legacy API tests
      document.getElementById("btn-warning").addEventListener("click", () => {
        Alert90s.show({
          title: "SYSTEM PROMPT",
          message: "ARE YOU SURE YOU WANT TO PROCEED?",
          type: "warning",
          showCancelButton: true,
          onConfirm: () => console.log("Confirmed Warning!"),
          onCancel: () => console.log("Cancelled Warning!"),
        });
      });

      document.getElementById("btn-danger").addEventListener("click", () => {
        Alert90s.show({
          title: "CRITICAL ERROR",
          message: "PERMANENT DELETION IMMINENT. CONTINUE?",
          type: "danger",
          confirmText: "YES, DELETE",
          onConfirm: () => console.log("Confirmed Danger!"),
        });
      });

      document.getElementById("btn-info").addEventListener("click", () => {
        Alert90s.show({
          title: "INFORMATION",
          message: "UPDATE INSTALLED SUCCESSFULLY.",
          type: "info",
          confirmText: "OK",
          showCancelButton: false,
          onConfirm: () => console.log("Confirmed Info!"),
        });
      });
    </script>
  </body>
</html>
